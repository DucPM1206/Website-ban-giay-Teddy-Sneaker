<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Danh sách thương hiệu</title>
    <link rel="stylesheet" href="/adminlte/pagination/simplePagination.css">
    <link rel="stylesheet" href="/adminlte/css/custom.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>

    <!-- Modal thêm thương hiệu-->
    <div class="container mt-5">
        <h2>Thêm Đợt Giảm Giá</h2>
        <form id="dotGiamGiaForm">
            <div class="form-group">
                <label for="ten_dot">Tên Đợt Giảm Giá</label>
                <input type="text" class="form-control" id="ten_dot" placeholder="Nhập tên đợt giảm giá" required>
            </div>
            <div class="form-group">
                <label for="gia_tri">Giá Trị</label>
                <input type="number" class="form-control" id="gia_tri" placeholder="Nhập giá trị giảm giá" required>
            </div>
            <div class="form-group">
                <label for="loai_giam_gia">Loại Giảm Giá</label>
                <select class="form-control" id="loai_giam_gia">
                    <option value="Phần trăm">Phần trăm</option>
                    <option value="Số tiền">Số tiền</option>
                </select>
            </div>
            <div class="form-group">
                <label for="gia_tri_giam_toi_da">Giá Trị Giảm Tối Đa</label>
                <input type="number" class="form-control" id="gia_tri_giam_toi_da" placeholder="Nhập giá trị giảm tối đa" required>
            </div>
            <div class="form-group">
                <label for="trang_thai">Trạng Thái</label>
                <select class="form-control" id="trang_thai">
                    <option value="true">Hoạt động</option>
                    <option value="false">Ngừng hoạt động</option>
                </select>
            </div>
            <div class="form-group">
                <label for="thoi_gian_bat_dau">Thời Gian Bắt Đầu</label>
                <input type="date" class="form-control" id="thoi_gian_bat_dau" required>
            </div>
            <div class="form-group">
                <label for="thoi_gian_ket_thuc">Thời Gian Kết Thúc</label>
                <input type="date" class="form-control" id="thoi_gian_ket_thuc" required>
            </div>
            <button type="submit" class="btn btn-primary">Thêm Đợt Giảm Giá</button>
            <a href="/list"  class="btn btn-primary">trở về</a>
        </form>
        <div id="successMessage" class="alert alert-success mt-3" style="display: none;">Thêm đợt giảm giá thành công!</div>
        <div id="errorMessage" class="alert alert-danger mt-3" style="display: none;">Có lỗi xảy ra, vui lòng thử lại!</div>
    </div>



    </section>
<script>
    document.getElementById('dotGiamGiaForm').addEventListener('submit', function (e) {
        e.preventDefault();

        // Lấy dữ liệu từ form
        const data = {
            ten_dot: document.getElementById('ten_dot').value,
            gia_tri: document.getElementById('gia_tri').value,
            loai_giam_gia: document.getElementById('loai_giam_gia').value,
            gia_tri_giam_toi_da: document.getElementById('gia_tri_giam_toi_da').value,
            trang_thai: document.getElementById('trang_thai').value === 'true',
            thoi_gian_bat_dau: document.getElementById('thoi_gian_bat_dau').value,
            thoi_gian_ket_thuc: document.getElementById('thoi_gian_ket_thuc').value,
            ngay_tao: new Date().toISOString().split('T')[0]
        };

        // Gửi yêu cầu POST
        fetch('http://localhost:8080/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then(response => {
                if (response.ok) {
                    // Hiển thị thông báo thành công
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('errorMessage').style.display = 'none';
                    document.getElementById('dotGiamGiaForm').reset();

                    // Cuộn trang lên để người dùng thấy thông báo
                    window.scrollTo(0, 0);

                    // Ẩn thông báo sau 3 giây
                    setTimeout(function() {
                        document.getElementById('successMessage').style.display = 'none';
                    }, 10000);
                } else {
                    throw new Error('Có lỗi xảy ra');
                }
            })
            .catch(error => {
                // Hiển thị thông báo lỗi
                document.getElementById('errorMessage').style.display = 'block';
                document.getElementById('successMessage').style.display = 'none';

                // Cuộn trang lên để người dùng thấy thông báo lỗi
                window.scrollTo(0, 0);

                // Ẩn thông báo lỗi sau 3 giây
                setTimeout(function() {
                    document.getElementById('errorMessage').style.display = 'none';
                }, 10000);
            });
    });

</script>
</body>